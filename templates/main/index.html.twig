{% extends 'base.html.twig' %}

{% block title %} {{ parent() }} | Accueil{% endblock %}

{% block body %}


<div class="example-wrapper">
    <p> Date du jour : {{ "now"|date("d/m/Y") }}</p>
    <p> Participant : <b>{{ app.user.prenom }} {{ app.user.nom | first }}.</b></p>

    <div>
        Filtrer les sorties :
        <form name="filtre" method="get">
            Campus :
            <select name="campus">
                <option></option>
                {% for campus in campus %}
                    <option>{{ campus.nom }}</option>
                {% endfor %}
            </select>
            <br>
            Le nom de la sortie contient :
            <input type="text" name="nomSortieContient">
            <br>
            Entre <input type="datetime-local" name="dateMin" >
            et <input type="datetime-local" name="dateMax" >
            <br>

                <input type="checkbox" value="1" id="organisateurTrue" name="organisateurTrue" checked>
                <label for="organisateurTrue">Sorties dont je suis l'oganisateur.trice</label>

                <input type="checkbox" name="inscritTrue" checked>
                <label for="inscritTrue">Sorties auxquelles je suis inscrit.e</label>


                <input type="checkbox" name="inscritFalse" checked>
                <label for="inscritFalse">Sorties auxquelles je ne suis pas inscrit.e</label>

                <input type="checkbox" name="sortiesPassees">
                <label for="sortiesPassees">Sorties passées</label>
            <br>
            <input type="button" value="Rechercher">
        </form>

    </div>


    <div  class="table-responsive">
        <table  class="table table-striped">
            <thead class="thead-light">
            <tr>
                <th scope="col">Nom de la sortie</th>
                <th scope="col">Date de la sortie</th>
                <th scope="col">Clôture</th>
                <th scope="col">inscrits/places</th>
                <th scope="col">Etat</th>
                <th scope="col">Inscrit</th>
                <th scope="col">organisateur</th>
                <th scope="col">Actions</th>
            </tr>
            </thead>
            {% if sorties %}
                {%  for sortie in sorties %}
                    <tbody>
                    <tr>
                        <td>{{ sortie.nom }}</td>
                        <td>{{ sortie.dateHeureDebut |date }}</td>
                        <td>{{ sortie.dateLimiteInscription |date }}</td>
                        <td>{{ sortie.participants.count }}/{{ sortie.nbInscriptionMax }}</td>
                        <td>{{ sortie.etat.libelle }}</td>
                        <td>
                            {% if sortie.participants.contains(app.user) %}
                                X
                            {% endif %}
                        </td>
                        <td>{{ sortie.organisateur.nom }}</td>
                        <td>//todo ajouter action</td>
                    </tr>
                    </tbody>
                {%  endfor %}
            {% else %}
                <p>Pas de sorties pour l'instant</p>
            {%  endif %}
        </table>
    </div>
</div>
{% endblock %}

{#{% block javascripts %}#}
{#    {{ parent() }}#}
{#    <script>#}
{#        function initListCampus()#}
{#        {#}
{#            fetch("http://127.0.0.1:8000/main", {#}
{#                method: 'GET',#}
{#                headers: {'Accept' : 'application/json'}#}
{#            })#}
{#                .then(response => response.json())#}
{#                .then(response => {#}
{#                    let options="";#}
{#                    response.map(campus => {#}
{#                        options += <option  value="${campus.id}">${campus.nom}</option>;#}
{#                    })#}
{#                    document.querySelector("#campus").innerHTML = options;#}
{#                })#}
{#                .catch(e =>{#}
{#                    alert(e)#}
{#                })#}
{#        }#}
{#        window.onload = () => {#}
{#            initListCampus();#}
{#        }#}
{#    </script>#}
{#{% endblock %}#}
